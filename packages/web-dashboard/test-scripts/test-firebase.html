<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase ì—°ê²° í…ŒìŠ¤íŠ¸</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ”¥ Firebase ì—°ê²° í…ŒìŠ¤íŠ¸</h1>
    <div id="status"></div>
    <div id="data"></div>

    <script>
        const statusDiv = document.getElementById('status');
        const dataDiv = document.getElementById('data');

        // Firebase ì„¤ì •
        const firebaseConfig = {
            apiKey: "AIzaSyDHPRlIqqYH25PyjMOAIe6BBzywEOo5a3w",
            authDomain: "goodpeople-95f54.firebaseapp.com",
            databaseURL: "https://goodpeople-95f54-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "goodpeople-95f54",
            storageBucket: "goodpeople-95f54.firebasestorage.app",
            messagingSenderId: "24321943098",
            appId: "1:24321943098:web:your_web_app_id"
        };

        try {
            // Firebase ì´ˆê¸°í™”
            firebase.initializeApp(firebaseConfig);
            statusDiv.innerHTML = '<div class="status success">âœ… Firebase ì´ˆê¸°í™” ì„±ê³µ!</div>';

            // Database ì°¸ì¡°
            const db = firebase.database();
            
            // ì¬ë‚œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            db.ref('calls').once('value').then(snapshot => {
                const data = snapshot.val();
                
                if (data) {
                    const calls = Object.entries(data).map(([id, call]) => ({
                        id,
                        ...call
                    }));
                    
                    statusDiv.innerHTML += '<div class="status success">âœ… ì¬ë‚œ ë°ì´í„° ë¡œë“œ ì„±ê³µ! (' + calls.length + 'ê°œ)</div>';
                    
                    // ë°ì´í„° í‘œì‹œ
                    dataDiv.innerHTML = '<h2>ğŸ“‹ ì¬ë‚œ ëª©ë¡</h2>';
                    calls.forEach(call => {
                        const hasLocation = call.lat && call.lng;
                        const hasResponder = call.responder ? 'ìˆìŒ' : 'ì—†ìŒ';
                        
                        dataDiv.innerHTML += `
                            <div class="status info">
                                <strong>ğŸš¨ ${call.eventType || 'ì •ë³´ì—†ìŒ'}</strong><br>
                                ID: ${call.id}<br>
                                ì£¼ì†Œ: ${call.address || 'ì •ë³´ì—†ìŒ'}<br>
                                ìœ„ì¹˜: ${hasLocation ? `ìœ„ë„ ${call.lat}, ê²½ë„ ${call.lng}` : 'âŒ ìœ„ì¹˜ ì •ë³´ ì—†ìŒ'}<br>
                                ìƒíƒœ: ${call.status || 'ì •ë³´ì—†ìŒ'}<br>
                                ëŒ€ì›: ${hasResponder}
                                ${call.responder ? `<br>- ${call.responder.name} (${call.responder.position})` : ''}
                            </div>
                        `;
                    });
                    
                    // ìœ„ì¹˜ ì •ë³´ê°€ ì—†ëŠ” ì¬ë‚œ í™•ì¸
                    const noLocationCalls = calls.filter(call => !call.lat || !call.lng);
                    if (noLocationCalls.length > 0) {
                        dataDiv.innerHTML += `<div class="status error">âš ï¸ ìœ„ì¹˜ ì •ë³´ê°€ ì—†ëŠ” ì¬ë‚œ: ${noLocationCalls.length}ê°œ</div>`;
                    }
                    
                } else {
                    statusDiv.innerHTML += '<div class="status error">âŒ ì¬ë‚œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                }
            }).catch(error => {
                statusDiv.innerHTML += '<div class="status error">âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨: ' + error.message + '</div>';
            });
            
        } catch (error) {
            statusDiv.innerHTML = '<div class="status error">âŒ Firebase ì´ˆê¸°í™” ì‹¤íŒ¨: ' + error.message + '</div>';
        }
    </script>
</body>
</html>
