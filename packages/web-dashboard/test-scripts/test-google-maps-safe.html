<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Maps API í…ŒìŠ¤íŠ¸ (ë³´ì•ˆ ë²„ì „)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        #map {
            height: 400px;
            width: 100%;
            margin-top: 20px;
            border: 2px solid #ccc;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .warning { background-color: #fff3cd; color: #856404; }
        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .api-key-input {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .api-key-input input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>ğŸ—ºï¸ Google Maps API í…ŒìŠ¤íŠ¸ (ë³´ì•ˆ ë²„ì „)</h1>
    
    <div class="api-key-input">
        <h3>âš ï¸ API í‚¤ ì…ë ¥</h3>
        <p>ì´ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ëŠ” API í‚¤ë¥¼ ì €ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
        <input type="password" id="apiKeyInput" placeholder="Google Maps API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
        <button onclick="loadGoogleMaps()">ì§€ë„ ë¡œë“œ</button>
        <div class="status warning">
            ğŸ’¡ íŒ: API í‚¤ëŠ” Google Cloud Consoleì—ì„œ ë°œê¸‰ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
            ë°˜ë“œì‹œ HTTP referrer ì œí•œì„ ì„¤ì •í•˜ì„¸ìš”!
        </div>
    </div>
    
    <div id="status"></div>
    
    <div id="mapControls" style="display: none;">
        <h2>í…ŒìŠ¤íŠ¸ ê¸°ëŠ¥</h2>
        <button onclick="addTestMarkers()">ğŸ“ í…ŒìŠ¤íŠ¸ ë§ˆì»¤ ì¶”ê°€</button>
        <button onclick="addResponderMarker()">ğŸš‘ ëŒ€ì› ë§ˆì»¤ ì¶”ê°€</button>
        <button onclick="drawRoute()">ğŸ“â¡ï¸ğŸ“ ê²½ë¡œ ê·¸ë¦¬ê¸°</button>
        <button onclick="moveToSeoul()">ğŸ“ ì„œìš¸ë¡œ ì´ë™</button>
    </div>
    
    <div id="map"></div>

    <script>
        // âš ï¸ API í‚¤ë¥¼ ì ˆëŒ€ ì´ íŒŒì¼ì— í•˜ë“œì½”ë”©í•˜ì§€ ë§ˆì„¸ìš”!
        // ì´ íŒŒì¼ì€ API í‚¤ ì—†ì´ ì»¤ë°‹ë˜ëŠ” ì•ˆì „í•œ ë²„ì „ì…ë‹ˆë‹¤.
        
        let map;
        let markers = [];
        let responderMarker;
        let polyline;
        const statusDiv = document.getElementById('status');

        function loadGoogleMaps() {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            
            if (!apiKey) {
                statusDiv.innerHTML = '<div class="status error">âŒ API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!</div>';
                return;
            }
            
            // ì´ë¯¸ ë¡œë“œëœ ê²½ìš° ì œê±°
            const existingScript = document.getElementById('googleMapsScript');
            if (existingScript) {
                existingScript.remove();
            }
            
            // Google Maps ìŠ¤í¬ë¦½íŠ¸ ë™ì  ë¡œë“œ
            const script = document.createElement('script');
            script.id = 'googleMapsScript';
            script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&callback=initMap&language=ko`;
            script.async = true;
            script.defer = true;
            
            script.onerror = function() {
                statusDiv.innerHTML = '<div class="status error">âŒ Google Maps API ë¡œë“œ ì‹¤íŒ¨! API í‚¤ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.</div>';
            };
            
            document.head.appendChild(script);
            statusDiv.innerHTML = '<div class="status warning">â³ Google Maps API ë¡œë”© ì¤‘...</div>';
        }

        function initMap() {
            try {
                // ì§€ë„ ìƒì„±
                map = new google.maps.Map(document.getElementById('map'), {
                    center: { lat: 37.5665, lng: 126.9780 }, // ì„œìš¸
                    zoom: 11
                });
                
                statusDiv.innerHTML = '<div class="status success">âœ… Google Maps ë¡œë“œ ì„±ê³µ!</div>';
                document.getElementById('mapControls').style.display = 'block';
                
                // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
                map.addListener('click', (e) => {
                    const lat = e.latLng.lat();
                    const lng = e.latLng.lng();
                    statusDiv.innerHTML += `<div class="status success">í´ë¦­ ìœ„ì¹˜: ìœ„ë„ ${lat.toFixed(6)}, ê²½ë„ ${lng.toFixed(6)}</div>`;
                });
                
            } catch (error) {
                statusDiv.innerHTML = '<div class="status error">âŒ Google Maps ì´ˆê¸°í™” ì‹¤íŒ¨: ' + error.message + '</div>';
            }
        }

        function addTestMarkers() {
            // ê¸°ì¡´ ë§ˆì»¤ ì œê±°
            markers.forEach(marker => marker.setMap(null));
            markers = [];
            
            // í…ŒìŠ¤íŠ¸ ì¬ë‚œ ìœ„ì¹˜
            const testLocations = [
                { lat: 37.5665, lng: 126.9780, title: "í™”ì¬ - ì„œìš¸ì—­" },
                { lat: 37.5700, lng: 126.9920, title: "êµ¬ê¸‰ - ì¢…ë¡œ" },
                { lat: 37.5550, lng: 126.9700, title: "êµ¬ì¡° - ë‚¨ì‚°" }
            ];
            
            testLocations.forEach((location, index) => {
                const marker = new google.maps.Marker({
                    position: { lat: location.lat, lng: location.lng },
                    map: map,
                    title: location.title,
                    label: (index + 1).toString()
                });
                
                const infoWindow = new google.maps.InfoWindow({
                    content: `<div style="padding: 10px;">
                        <strong>${location.title}</strong><br>
                        ìœ„ë„: ${location.lat}<br>
                        ê²½ë„: ${location.lng}
                    </div>`
                });
                
                marker.addListener('click', () => {
                    infoWindow.open(map, marker);
                    map.setCenter(marker.getPosition());
                    map.setZoom(14);
                });
                
                markers.push(marker);
            });
            
            statusDiv.innerHTML += '<div class="status success">âœ… í…ŒìŠ¤íŠ¸ ë§ˆì»¤ 3ê°œ ì¶”ê°€ë¨</div>';
        }

        function addResponderMarker() {
            // ê¸°ì¡´ ëŒ€ì› ë§ˆì»¤ ì œê±°
            if (responderMarker) {
                responderMarker.setMap(null);
            }
            
            // ëŒ€ì› ìœ„ì¹˜ (ì„œìš¸ì—­ ê·¼ì²˜)
            const responderPosition = { lat: 37.5680, lng: 126.9750 };
            
            responderMarker = new google.maps.Marker({
                position: responderPosition,
                map: map,
                title: "ê¹€ì² ìˆ˜ ëŒ€ì›",
                icon: {
                    url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`
                        <svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="20" cy="20" r="18" fill="#2196F3" stroke="white" stroke-width="2"/>
                            <text x="20" y="26" font-family="Arial" font-size="20" fill="white" text-anchor="middle">ğŸš‘</text>
                        </svg>
                    `),
                    scaledSize: new google.maps.Size(40, 40),
                    anchor: new google.maps.Point(20, 20)
                }
            });
            
            const infoWindow = new google.maps.InfoWindow({
                content: `<div style="padding: 10px;">
                    <strong>ê¹€ì² ìˆ˜ ëŒ€ì›</strong><br>
                    ì§ì±…: êµ¬ê¸‰ëŒ€ì›<br>
                    ìƒíƒœ: ì¶œë™ì¤‘
                </div>`
            });
            
            responderMarker.addListener('click', () => {
                infoWindow.open(map, responderMarker);
            });
            
            statusDiv.innerHTML += '<div class="status success">âœ… ëŒ€ì› ë§ˆì»¤ ì¶”ê°€ë¨</div>';
        }

        function drawRoute() {
            // ê¸°ì¡´ ê²½ë¡œ ì œê±°
            if (polyline) {
                polyline.setMap(null);
            }
            
            if (!responderMarker || markers.length === 0) {
                alert('ë¨¼ì € í…ŒìŠ¤íŠ¸ ë§ˆì»¤ì™€ ëŒ€ì› ë§ˆì»¤ë¥¼ ì¶”ê°€í•˜ì„¸ìš”!');
                return;
            }
            
            // ëŒ€ì› ìœ„ì¹˜ì—ì„œ ì²« ë²ˆì§¸ ë§ˆì»¤ê¹Œì§€ ê²½ë¡œ
            const path = [
                responderMarker.getPosition(),
                markers[0].getPosition()
            ];
            
            polyline = new google.maps.Polyline({
                path: path,
                geodesic: true,
                strokeColor: '#2196F3',
                strokeOpacity: 1.0,
                strokeWeight: 3,
                icons: [{
                    icon: {
                        path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW,
                        scale: 3
                    },
                    offset: '100%'
                }]
            });
            
            polyline.setMap(map);
            
            // ê²½ë¡œê°€ ë³´ì´ë„ë¡ ì¤Œ ì¡°ì •
            const bounds = new google.maps.LatLngBounds();
            path.forEach(point => bounds.extend(point));
            map.fitBounds(bounds);
            
            statusDiv.innerHTML += '<div class="status success">âœ… ê²½ë¡œ í‘œì‹œë¨</div>';
        }

        function moveToSeoul() {
            map.setCenter({ lat: 37.5665, lng: 126.9780 });
            map.setZoom(11);
            statusDiv.innerHTML += '<div class="status success">âœ… ì„œìš¸ë¡œ ì´ë™</div>';
        }
        
        // ì „ì—­ í•¨ìˆ˜ë¡œ ì„¤ì • (Google Maps ì½œë°±ìš©)
        window.initMap = initMap;
    </script>
</body>
</html>